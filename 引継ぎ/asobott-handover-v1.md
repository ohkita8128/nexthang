# ã‚ããƒœãƒƒãƒˆ Phase 1 å¼•ç¶™ãè³‡æ–™

## åŸºæœ¬æƒ…å ±
- **ã‚µãƒ¼ãƒ“ã‚¹å**: ã‚ããƒœãƒƒãƒˆ
- **ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå**: asobott
- **æœ¬ç•ªURL**: https://nexthang.vercel.appï¼ˆâ†’ asobott.vercel.app ã«å¤‰æ›´äºˆå®šï¼‰
- **LIFF URL**: https://liff.line.me/2009015521-LvLwajYC
- **ãƒ­ãƒ¼ã‚«ãƒ«**: `C:\Users\PC_User\Documents\GitHub\nexthang`ï¼ˆâ†’ asobott ã«å¤‰æ›´äºˆå®šï¼‰
- **GitHub**: https://github.com/ohkita8128/nexthangï¼ˆâ†’ asobott ã«å¤‰æ›´äºˆå®šï¼‰
- **æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯**: Next.js 14 + TypeScript + Tailwind v4 + Supabase + Vercel
- **ä½œæ¥­æ—¥**: 2026å¹´1æœˆ31æ—¥

---

## åå‰å¤‰æ›´äºˆå®š

| ç”¨é€” | ç¾åœ¨ | å¤‰æ›´å¾Œ |
|------|------|--------|
| ã‚µãƒ¼ãƒ“ã‚¹å | NextHang | ã‚ããƒœãƒƒãƒˆ |
| ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå | nexthang | asobott |
| GitHub ãƒªãƒã‚¸ãƒˆãƒª | nexthang | asobott |
| Vercel ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ | nexthang | asobott |
| URL | nexthang.vercel.app | asobott.vercel.app |
| LINE å…¬å¼ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ | NextHang | ã‚ããƒœãƒƒãƒˆ |

### åå‰å¤‰æ›´ã®æ‰‹é †
1. GitHub ãƒªãƒã‚¸ãƒˆãƒªåå¤‰æ›´ï¼ˆSettings â†’ Renameï¼‰
2. Vercel ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåå¤‰æ›´ï¼ˆSettings â†’ Generalï¼‰
3. LINE Official Account Manager ã§ã‚¢ã‚«ã‚¦ãƒ³ãƒˆåå¤‰æ›´
4. LINE Developers Console ã§ LIFF ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ URL å¤‰æ›´
5. ã‚³ãƒ¼ãƒ‰å†…ã®åå‰å¤‰æ›´ï¼ˆã‚¿ã‚¤ãƒˆãƒ«ã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸æ–‡è¨€ï¼‰
6. ãƒ­ãƒ¼ã‚«ãƒ«ãƒ•ã‚©ãƒ«ãƒ€åå¤‰æ›´

---

## ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦

### ç›®çš„
ã€Œäºˆå®šãŒå­˜åœ¨ã—ãªã„ã¾ã¾æ™‚é–“ãŒéãã‚‹ã€å•é¡Œã‚’è§£æ±ºã™ã‚‹ LINE Bot + ç®¡ç†ç”»é¢ã‚¢ãƒ—ãƒª

### ã‚¿ãƒ¼ã‚²ãƒƒãƒˆ
ä»²è‰¯ã—ã ã‘ã©å‹•ã‹ãªã„å‹é”ã‚°ãƒ«ãƒ¼ãƒ—

### ã‚³ãƒ³ã‚»ãƒ—ãƒˆ
- Bot ãŒè‡ªå‹•ã§èª˜ã†ï¼ˆèª°ã‚‚è¨€ã„å‡ºã•ãªãã¦ã„ã„ï¼‰
- æ—¥ä»˜ãªã—ã§ã€Œè¡ŒããŸã„ã€ã‚’æºœã‚ã‚‰ã‚Œã‚‹
- äººæ•°é›†ã¾ã‚‰ãªãã¦ã‚‚å¤±æ•—ã«ãªã‚‰ãªã„
- å…¨éƒ¨ LINE å†…ã§å®Œçµ

---

## å®Œäº†ã—ãŸã‚¿ã‚¹ã‚¯

### âœ… LINE Bot åŸºæœ¬æ©Ÿèƒ½
- LINE å…¬å¼ã‚¢ã‚«ã‚¦ãƒ³ãƒˆä½œæˆ
- Webhook å®Ÿè£…ï¼ˆfollow, join, memberJoined, leave, memberLeft, messageï¼‰
- å‹é”è¿½åŠ æ™‚ã®ã‚¦ã‚§ãƒ«ã‚«ãƒ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
- ã‚°ãƒ«ãƒ¼ãƒ—å‚åŠ æ™‚ã®æŒ¨æ‹¶ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
- ã€Œãƒ¡ãƒ‹ãƒ¥ãƒ¼ã€ã‚³ãƒãƒ³ãƒ‰ã§ LIFF ãƒªãƒ³ã‚¯é€ä¿¡

### âœ… ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹
- Supabase ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆ
- 8ãƒ†ãƒ¼ãƒ–ãƒ«ä½œæˆæ¸ˆã¿
  - users
  - groups
  - group_members
  - events
  - votes
  - wishes
  - interests
  - reminders

### âœ… LIFF ç®¡ç†ç”»é¢
- LIFF ã‚¢ãƒ—ãƒªç™»éŒ²ï¼ˆLINE ãƒ­ã‚°ã‚¤ãƒ³ãƒãƒ£ãƒãƒ«çµŒç”±ï¼‰
- ãƒ›ãƒ¼ãƒ ãƒšãƒ¼ã‚¸
- è¡ŒããŸã„ãƒªã‚¹ãƒˆä¸€è¦§
- è¡ŒããŸã„è¿½åŠ ãƒ•ã‚©ãƒ¼ãƒ 
- ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ãƒšãƒ¼ã‚¸ï¼ˆæº–å‚™ä¸­è¡¨ç¤ºï¼‰
- è¨­å®šãƒšãƒ¼ã‚¸ï¼ˆæº–å‚™ä¸­è¡¨ç¤ºï¼‰
- ãƒœãƒˆãƒ ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³

### âœ… ãƒªãƒƒãƒãƒ¡ãƒ‹ãƒ¥ãƒ¼
- LINE Official Account Manager ã§è¨­å®š
- ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆéè¡¨ç¤ºï¼ˆã‚¿ãƒƒãƒ—ã§é–‹ãï¼‰

### âœ… ãƒ‡ã‚¶ã‚¤ãƒ³
- Tailwind v4 å¯¾å¿œ
- ãƒ—ãƒ­ãƒ•ã‚§ãƒƒã‚·ãƒ§ãƒŠãƒ«ãª UIï¼ˆslate ç³»ã‚«ãƒ©ãƒ¼ã€SVG ã‚¢ã‚¤ã‚³ãƒ³ï¼‰

---

## æœªè§£æ±ºã®å•é¡Œ

### ğŸ”´ ã‚°ãƒ«ãƒ¼ãƒ—ã‹ã‚‰ã® LIFF ã‚¢ã‚¯ã‚»ã‚¹ã§ã‚¨ãƒ©ãƒ¼

**ç—‡çŠ¶**: ã‚°ãƒ«ãƒ¼ãƒ—ã®ãƒˆãƒ¼ã‚¯ã‹ã‚‰ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’é–‹ãã¨ã€è¡ŒããŸã„ãƒªã‚¹ãƒˆãŒæ°¸é ã«èª­ã¿è¾¼ã¿ä¸­

**åŸå› **: `/api/groups/by-line-id` ãŒ 500 ã‚¨ãƒ©ãƒ¼ã‚’è¿”ã—ã¦ã„ã‚‹

**èª¿æŸ»çŠ¶æ³**: 
- 1:1 ãƒˆãƒ¼ã‚¯ã‚„ PC ã‹ã‚‰ã¯æ­£å¸¸å‹•ä½œ
- ã‚°ãƒ«ãƒ¼ãƒ—ã‹ã‚‰ã®ã¿ã‚¨ãƒ©ãƒ¼
- LIFF ã® context.groupId ã¨ DB ã® line_group_id ã®ä¸ä¸€è‡´ã®å¯èƒ½æ€§

**æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—**:
1. Vercel ãƒ­ã‚°ã§è©³ç´°ãªã‚¨ãƒ©ãƒ¼ã‚’ç¢ºèª
2. LIFF ã§å–å¾—ã•ã‚Œã‚‹ groupId ã‚’ãƒ­ã‚°å‡ºåŠ›ã—ã¦ç¢ºèª
3. DB ã® groups ãƒ†ãƒ¼ãƒ–ãƒ«ã® line_group_id ã¨æ¯”è¼ƒ

---

## ãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆ

```
nexthang/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ app/
â”‚   â”‚   â”œâ”€â”€ globals.css              # Tailwind v4 import
â”‚   â”‚   â”œâ”€â”€ layout.tsx               # ãƒ«ãƒ¼ãƒˆãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ
â”‚   â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â”‚   â”œâ”€â”€ webhook/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ route.ts         # LINE Webhook
â”‚   â”‚   â”‚   â”œâ”€â”€ groups/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ by-line-id/
â”‚   â”‚   â”‚   â”‚   â”‚   â””â”€â”€ route.ts     # LINE ã‚°ãƒ«ãƒ¼ãƒ—ID â†’ DB ID å¤‰æ›
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ [groupId]/
â”‚   â”‚   â”‚   â”‚       â””â”€â”€ wishes/
â”‚   â”‚   â”‚   â”‚           â””â”€â”€ route.ts # è¡ŒããŸã„ãƒªã‚¹ãƒˆ CRUD
â”‚   â”‚   â”‚   â”œâ”€â”€ wishes/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ [wishId]/
â”‚   â”‚   â”‚   â”‚       â”œâ”€â”€ route.ts     # è¡ŒããŸã„å‰Šé™¤
â”‚   â”‚   â”‚   â”‚       â””â”€â”€ interest/
â”‚   â”‚   â”‚   â”‚           â””â”€â”€ route.ts # èˆˆå‘³è¿½åŠ /å‰Šé™¤
â”‚   â”‚   â”‚   â””â”€â”€ user-groups/
â”‚   â”‚   â”‚       â””â”€â”€ route.ts         # ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æ‰€å±ã‚°ãƒ«ãƒ¼ãƒ—å–å¾—
â”‚   â”‚   â””â”€â”€ liff/
â”‚   â”‚       â”œâ”€â”€ page.tsx             # ãƒ›ãƒ¼ãƒ 
â”‚   â”‚       â”œâ”€â”€ calendar/
â”‚   â”‚       â”‚   â””â”€â”€ page.tsx         # ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ï¼ˆæº–å‚™ä¸­ï¼‰
â”‚   â”‚       â”œâ”€â”€ wishes/
â”‚   â”‚       â”‚   â”œâ”€â”€ page.tsx         # è¡ŒããŸã„ãƒªã‚¹ãƒˆ
â”‚   â”‚       â”‚   â””â”€â”€ new/
â”‚   â”‚       â”‚       â””â”€â”€ page.tsx     # è¡ŒããŸã„è¿½åŠ 
â”‚   â”‚       â””â”€â”€ settings/
â”‚   â”‚           â””â”€â”€ page.tsx         # è¨­å®šï¼ˆæº–å‚™ä¸­ï¼‰
â”‚   â”œâ”€â”€ hooks/
â”‚   â”‚   â””â”€â”€ use-liff.ts              # LIFF åˆæœŸåŒ–ãƒ»ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«å–å¾—
â”‚   â””â”€â”€ lib/
â”‚       â”œâ”€â”€ line/
â”‚       â”‚   â””â”€â”€ client.ts            # LINE Messaging API ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ
â”‚       â””â”€â”€ supabase/
â”‚           â””â”€â”€ client.ts            # Supabase ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ
â”œâ”€â”€ tailwind.config.ts
â”œâ”€â”€ postcss.config.mjs
â”œâ”€â”€ next.config.ts
â”œâ”€â”€ .env.local                       # ç’°å¢ƒå¤‰æ•°ï¼ˆãƒ­ãƒ¼ã‚«ãƒ«ï¼‰
â””â”€â”€ package.json
```

---

## ç’°å¢ƒå¤‰æ•°

### .env.localï¼ˆãƒ­ãƒ¼ã‚«ãƒ«ï¼‰
```env
# LINE
LINE_CHANNEL_ID=xxxxx
LINE_CHANNEL_SECRET=xxxxx
LINE_CHANNEL_ACCESS_TOKEN=xxxxx

# LIFF
NEXT_PUBLIC_LIFF_ID=2009015521-LvLwajYC

# Supabase
NEXT_PUBLIC_SUPABASE_URL=https://xxxxx.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=xxxxx
SUPABASE_SERVICE_ROLE_KEY=xxxxx

# App
NEXT_PUBLIC_APP_URL=http://localhost:3000
```

### Vercel ç’°å¢ƒå¤‰æ•°
ä¸Šè¨˜ã¨åŒã˜ã‚‚ã®ã‚’ Vercel ã® Environment Variables ã«è¨­å®šæ¸ˆã¿

---

## ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ§‹é€ 

### users
| ã‚«ãƒ©ãƒ  | å‹ | èª¬æ˜ |
|--------|-----|------|
| id | uuid | PK |
| line_user_id | text | LINE ãƒ¦ãƒ¼ã‚¶ãƒ¼ID |
| display_name | text | è¡¨ç¤ºå |
| picture_url | text | ã‚¢ã‚¤ã‚³ãƒ³URL |
| created_at | timestamptz | ä½œæˆæ—¥æ™‚ |
| updated_at | timestamptz | æ›´æ–°æ—¥æ™‚ |

### groups
| ã‚«ãƒ©ãƒ  | å‹ | èª¬æ˜ |
|--------|-----|------|
| id | uuid | PK |
| line_group_id | text | LINE ã‚°ãƒ«ãƒ¼ãƒ—ID |
| name | text | ã‚°ãƒ«ãƒ¼ãƒ—å |
| created_by | uuid | FK â†’ users |
| settings | jsonb | ã‚°ãƒ«ãƒ¼ãƒ—è¨­å®š |
| created_at | timestamptz | ä½œæˆæ—¥æ™‚ |
| updated_at | timestamptz | æ›´æ–°æ—¥æ™‚ |

### group_members
| ã‚«ãƒ©ãƒ  | å‹ | èª¬æ˜ |
|--------|-----|------|
| id | uuid | PK |
| group_id | uuid | FK â†’ groups |
| user_id | uuid | FK â†’ users |
| role | text | admin / member |
| joined_at | timestamptz | å‚åŠ æ—¥æ™‚ |

### wishes
| ã‚«ãƒ©ãƒ  | å‹ | èª¬æ˜ |
|--------|-----|------|
| id | uuid | PK |
| group_id | uuid | FK â†’ groups |
| title | text | è¡ŒããŸã„å†…å®¹ |
| description | text | è©³ç´° |
| created_by | uuid | FK â†’ users |
| is_anonymous | boolean | åŒ¿åã‹ |
| status | text | open / voting / converted / archived |
| converted_to | uuid | FK â†’ events |
| created_at | timestamptz | ä½œæˆæ—¥æ™‚ |

### interests
| ã‚«ãƒ©ãƒ  | å‹ | èª¬æ˜ |
|--------|-----|------|
| id | uuid | PK |
| wish_id | uuid | FK â†’ wishes |
| user_id | uuid | FK â†’ users |
| created_at | timestamptz | ä½œæˆæ—¥æ™‚ |

### events, votes, reminders
è¨­è¨ˆæ¸ˆã¿ã€ã¾ã æ©Ÿèƒ½æœªå®Ÿè£…

---

## å¤–éƒ¨ã‚µãƒ¼ãƒ“ã‚¹æƒ…å ±

### LINE Developers Console
- URL: https://developers.line.biz/console/
- ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼: NextHangï¼ˆã¾ãŸã¯å€‹äººåï¼‰
- ãƒãƒ£ãƒãƒ«:
  - Messaging API ãƒãƒ£ãƒãƒ«: NextHang
  - LINE ãƒ­ã‚°ã‚¤ãƒ³ãƒãƒ£ãƒãƒ«: NextHang LIFF

### LINE Official Account Manager
- URL: https://manager.line.biz/
- ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ: NextHang
- ãƒªãƒƒãƒãƒ¡ãƒ‹ãƒ¥ãƒ¼è¨­å®šæ¸ˆã¿

### Supabase
- URL: https://supabase.com/dashboard
- ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ: nexthang

### Vercel
- URL: https://vercel.com/
- ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ: nexthang

---

## æ¬¡å›ã‚„ã‚‹ã¹ãã“ã¨

### å„ªå…ˆåº¦ï¼šé«˜
1. **ã‚°ãƒ«ãƒ¼ãƒ—ã‹ã‚‰ã® LIFF ã‚¢ã‚¯ã‚»ã‚¹å•é¡Œã‚’ä¿®æ­£**
   - LIFF context.groupId ã®ãƒ­ã‚°å‡ºåŠ›è¿½åŠ 
   - DB ã® line_group_id ã¨ã®æ¯”è¼ƒ
   - ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°æ”¹å–„

2. **group_members ã®è‡ªå‹•ç™»éŒ²**
   - Bot ãŒã‚°ãƒ«ãƒ¼ãƒ—ã«å‚åŠ ã—ãŸæ™‚ç‚¹ã§æ—¢å­˜ãƒ¡ãƒ³ãƒãƒ¼ã‚’ç™»éŒ²ã™ã‚‹æ–¹æ³•ã‚’æ¤œè¨
   - ç¾çŠ¶ã¯ memberJoined ã‚¤ãƒ™ãƒ³ãƒˆã§ã—ã‹ç™»éŒ²ã•ã‚Œãªã„

### å„ªå…ˆåº¦ï¼šä¸­
3. **æ—¥ç¨‹æŠ•ç¥¨æ©Ÿèƒ½**
   - ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ UI å®Ÿè£…
   - events ãƒ†ãƒ¼ãƒ–ãƒ«æ“ä½œ API
   - votes ãƒ†ãƒ¼ãƒ–ãƒ«æ“ä½œ API

4. **ãƒªãƒã‚¤ãƒ³ãƒ‰æ©Ÿèƒ½**
   - Supabase Edge Functions ã§å®šæœŸå®Ÿè¡Œ
   - ã¾ãŸã¯ Vercel Cron Jobs

### å„ªå…ˆåº¦ï¼šä½
5. **è¨­å®šç”»é¢ã®å®Ÿè£…**
6. **ãŠã™ã™ã‚ææ¡ˆæ©Ÿèƒ½**
7. **Google Calendar é€£æº**

---

## æŠ€è¡“ãƒ¡ãƒ¢

### Tailwind v4 ã®è¨­å®š
postcss.config.mjs ã§ `@tailwindcss/postcss` ã‚’ä½¿ç”¨
globals.css ã§ã¯ `@import "tailwindcss";` ã¨è¨˜è¿°

### LIFF ã®æ³¨æ„ç‚¹
- Messaging API ãƒãƒ£ãƒãƒ«ã«ã¯ LIFF ã‚’è¿½åŠ ã§ããªã„
- LINE ãƒ­ã‚°ã‚¤ãƒ³ãƒãƒ£ãƒãƒ«ã‚’åˆ¥é€”ä½œæˆã—ã¦ LIFF ã‚’è¿½åŠ 
- ã‚°ãƒ«ãƒ¼ãƒ—ã‹ã‚‰é–‹ãã¨ context.groupId ãŒå–å¾—ã§ãã‚‹

### LINE Bot ã®ã‚°ãƒ«ãƒ¼ãƒ—å‚åŠ è¨±å¯
LINE Official Account Manager â†’ è¨­å®š â†’ ã‚¢ã‚«ã‚¦ãƒ³ãƒˆè¨­å®š â†’ æ©Ÿèƒ½ã®åˆ©ç”¨
ã€Œã‚°ãƒ«ãƒ¼ãƒ—ãƒ»è¤‡æ•°äººãƒˆãƒ¼ã‚¯ã¸ã®å‚åŠ ã‚’è¨±å¯ã™ã‚‹ã€ã‚’ã‚ªãƒ³ã«ã™ã‚‹

---

## è¨­è¨ˆæ›¸
- è¨­è¨ˆæ›¸ v1: `å¼•ç¶™ã/nexthang-design-v1.md`ï¼ˆãƒ­ãƒ¼ã‚«ãƒ«ã«ä¿å­˜æ¸ˆã¿ï¼‰

---

## å¤‰æ›´å±¥æ­´

| æ—¥ä»˜ | å†…å®¹ |
|------|------|
| 2026/01/31 | Phase 1 å®Œäº†ã€‚BotåŸºæœ¬æ©Ÿèƒ½ã€LIFFç®¡ç†ç”»é¢ã€è¡ŒããŸã„ãƒªã‚¹ãƒˆæ©Ÿèƒ½ |
